---
external help file: CosmosDB-help.xml
Module Name: CosmosDB
online version:
schema: 2.0.0
---

# New-CosmosDbContext

## SYNOPSIS

Create a context object containing the information required
to connect to a CosmosDB.

## SYNTAX

### Context (Default)

```powershell
New-CosmosDbContext -Account <String> [-Database <String>] -Key <SecureString> [-KeyType <String>]
 [-RetryPolicy <CosmosDB.RetryPolicy>] [<CommonParameters>]
```

### Azure

```powershell
New-CosmosDbContext -Account <String> [-Database <String>] -ResourceGroup <String> [-MasterKeyType <String>]
 [-RetryPolicy <CosmosDB.RetryPolicy>] [<CommonParameters>]
```

### Emulator

```powershell
New-CosmosDbContext [-Database <String>] [-Emulator] [-Port <Int16>] [-RetryPolicy <CosmosDB.RetryPolicy>]
 [<CommonParameters>]
```

## DESCRIPTION

This cmdlet is used to simplify the calling of the CosmosDB
cmdlets by providing all the context information in an
object that can be passed to the CosmosDB cmdlets.

It can also retrieve the CosmosDB primary or secondary key
from Azure Resource Manager.

A retry policy can be applied to the context to control
the behavior of "Too Many Request" (error code 429) responses
from Cosmos DB.

## EXAMPLES

### EXAMPLE 1

```powershell
PS C:\> $primaryKey = ConvertTo-SecureString -String 'your master key' -AsPlainText -Force
PS C:\> $cosmosDbContext = New-CosmosDbContext -Account 'MyAzureCosmosDB' -Database 'MyDatabase' -Key $primaryKey
```

Creates a CosmosDB context specifying the master key manually.

### EXAMPLE 2

```powershell
PS C:\> Add-AzureRmAccount
PS C:\> $cosmosDbContext = New-CosmosDbContext -Account 'MyAzureCosmosDB' -Database 'MyDatabase' -ResourceGroup 'MyCosmosDbResourceGroup' -MasterKeyType 'PrimaryMasterKey'
```

Creates a CosmosDB context by logging into Azure and getting
it from the portal.

### EXAMPLE 3

```powershell
PS C:\> $cosmosDbContext = New-CosmosDbContext -Emulator
```

Creates a CosmosDB context by using a local CosmosDB Emulator.

### EXAMPLE 4

```powershell
PS C:\> $primaryKey = ConvertTo-SecureString -String 'your master key' -AsPlainText -Force
PS C:\> $retryPolicy = New-CosmosDBRetryPolicy -MaxRetries 5 -Delay 2
PS C:\> $cosmosDbContext = New-CosmosDbContext -Account 'MyAzureCosmosDB' -Database 'MyDatabase' -Key $primaryKey -RetryPolicy $retryPolicy
```

Creates a CosmosDB context specifying the master key manually. A
retry policy will be applied to the context that allows 5 retries
with a delay of 2 seconds between them.

## PARAMETERS

### -Account

The account name of the CosmosDB to access.

```yaml
Type: String
Parameter Sets: Account, Token, AzureAccount
Aliases:

Required: True
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -Database

The name of the database to access in the CosmosDB account.

```yaml
Type: String
Parameter Sets: (All)
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -Key

The key to be used to access this CosmosDB.

```yaml
Type: SecureString
Parameter Sets: Account
Aliases:

Required: True
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -KeyType

The type of key that will be used to access ths CosmosDB.

Note: This parameter should always be set to master and
will be deprecated in a future release. Do not use it.

```yaml
Type: String
Parameter Sets: Account
Aliases:

Required: False
Position: Named
Default value: Master
Accept pipeline input: False
Accept wildcard characters: False
```

### -ResourceGroup

This is the name of the Azure Resouce Group containing the
CosmosDB.

```yaml
Type: String
Parameter Sets: AzureAccount
Aliases:

Required: True
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -MasterKeyType

This is the master key type to use retrieve from Azure for
the CosmosDB.

```yaml
Type: String
Parameter Sets: AzureAccount
Aliases:

Required: False
Position: Named
Default value: PrimaryMasterKey
Accept pipeline input: False
Accept wildcard characters: False
```

### -Emulator

Using this switch creates a context for a CosmosDB emulator
installed onto the local host.

```yaml
Type: SwitchParameter
Parameter Sets: Emulator
Aliases:

Required: False
Position: Named
Default value: False
Accept pipeline input: False
Accept wildcard characters: False
```

### -Port

This is the port the CosmosDB emulator is installed onto.
If not specified it will use the default port of 8081.

```yaml
Type: Int16
Parameter Sets: Emulator
Aliases:

Required: False
Position: Named
Default value: 8081
Accept pipeline input: False
Accept wildcard characters: False
```

### -Token

This is an array of Token objects. These can be generated by
retrieving a CosmosDB user account that has had permissions assigned.

```yaml
Type: CosmosDB.Token
Parameter Sets: Emulator, Token
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### -BackoffPolicy

This a Back-off Policy object that controls the retry behaviour for
requests using this context.

```yaml
Type: CosmosDB.BackoffPolicy
Parameter Sets:  (All)
Aliases:

Required: False
Position: Named
Default value: None
Accept pipeline input: False
Accept wildcard characters: False
```

### CommonParameters

This cmdlet supports the common parameters: -Debug, -ErrorAction, -ErrorVariable, -InformationAction, -InformationVariable, -OutVariable, -OutBuffer, -PipelineVariable, -Verbose, -WarningAction, and -WarningVariable.
For more information, see about_CommonParameters (http://go.microsoft.com/fwlink/?LinkID=113216).

## INPUTS

## OUTPUTS

### System.Management.Automation.PSCustomObject

## NOTES

## RELATED LINKS
